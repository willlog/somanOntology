!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.KendoDataQuery=t():e.KendoDataQuery=t()}(this,function(){return function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={exports:{},id:n,loaded:!1};return e[n].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){"use strict";var n=r(1);t.isCompositeFilterDescriptor=n.isCompositeFilterDescriptor;var i=r(3);t.toODataString=i.toODataString;var o=r(7);t.toDataSourceRequestString=o.toDataSourceRequestString;var u=r(9);t.translateDataSourceResultGroups=u.translateDataSourceResultGroups,t.translateAggregateResults=u.translateAggregateResults;var s=r(10);t.orderBy=s.orderBy,t.process=s.process,t.distinct=s.distinct;var a=r(8);t.expr=a.expr,t.getter=a.getter;var c=r(15);t.filterBy=c.filterBy,t.compileFilter=c.compileFilter;var f=r(12);t.groupBy=f.groupBy;var l=r(11);t.composeSortDescriptors=l.composeSortDescriptors;var g=r(15);t.filterExpr=g.filterExpr;var p=r(16);t.normalizeFilters=p.normalizeFilters;var d=r(12);t.normalizeGroups=d.normalizeGroups;var v=r(14);t.aggregateBy=v.aggregateBy},function(e,t,r){"use strict";var n=r(2);t.isCompositeFilterDescriptor=function(e){return n.isPresent(e.filters)}},function(e,t){"use strict";t.isPresent=function(e){return null!==e&&void 0!==e},t.isBlank=function(e){return null===e||void 0===e},t.isArray=function(e){return Array.isArray(e)},t.isFunction=function(e){return"function"==typeof e},t.isString=function(e){return"string"==typeof e},t.isTruthy=function(e){return!!e},t.isNullOrEmptyString=function(e){return t.isBlank(e)||0===e.trim().length},t.isNotNullOrEmptyString=function(e){return!t.isNullOrEmptyString(e)},t.isNumeric=function(e){return!isNaN(e-parseFloat(e))},t.isDate=function(e){return e&&e.getTime}},function(e,t,r){"use strict";var n=r(2),i=r(4),o=function(e){var t=e.filter(function(e){return n.isPresent(e.dir)}).map(function(e){var t=e.field.replace(/\./g,"/");return"desc"===e.dir?t+" desc":t}).join(",");return t?"$orderby="+t:t},u=function(e,t){return{filter:i.serializeFilter(t.filter||{}),skip:"$skip="+t.skip,sort:o(t.sort||[]),take:"$top="+t.take}[e]};t.toODataString=function(e){return Object.keys(e).map(function(t){return u(t,e)}).filter(n.isNotNullOrEmptyString).join("&")}},function(e,t,r){"use strict";var n=r(1),i=r(5),o=r(6),u=function(e){return function(t){var r=t.field,n=t.value;return e+"("+r+","+n+")"}},s=function(e){return function(t){var r=t.field,n=t.value;return r+" "+e+" "+n}},a=function(e){return i.compose(e,o.quote,o.toLower,o.normalizeField)},c=function(e){return a(u(e))},f=function(e){return a(s(e))},l=function(e){return i.compose(s(e),o.normalizeField)},g=function(e){return i.compose(s(e),o.normalizeField,o.formatDate)},p=function(e){return i.either(o.isDateValue,g(e),l(e))},d=function(e){return i.either(o.isStringValue,f(e),p(e))},v=function(e){return e+" eq -1"},m={contains:c("contains"),doesnotcontain:i.compose(v,c("indexof")),endswith:c("endswith"),eq:d("eq"),gt:d("gt"),gte:d("ge"),isempty:function(e){var t=e.field;return t+" eq ''"},isnotempty:function(e){var t=e.field;return t+" ne ''"},isnotnull:function(e){var t=e.field;return t+" ne null"},isnull:function(e){var t=e.field;return t+" eq null"},lt:d("lt"),lte:d("le"),neq:d("ne"),startswith:c("startswith")},h=function(e){return" "+e.logic+" "},y=function(e){return m[e.operator](e)},x=o.serializeFilters(function(e){return i.either(n.isCompositeFilterDescriptor,x,y)(e)},h);t.serializeFilter=function(e){return e.filters&&e.filters.length?"$filter="+x(e):""}},function(e,t){"use strict";t.either=function(e,t,r){return function(n){return e(n)?t(n):r(n)}},t.compose=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return function(t){return e.reduceRight(function(e,t){return t(e)},t)}}},function(e,t,r){"use strict";var n=r(2);t.wrapIf=function(e){return function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];return e()?""+t[0]+r[0]+t[1]:r[0]}},t.toUTC=function(e){return new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()))},t.quote=function(e){var t=e.field,r=e.value,n=e.ignoreCase,i=e.operator;return{value:"'"+r.replace(/'/g,"''")+"'",field:t,ignoreCase:n,operator:i}},t.formatDate=function(e){var r=e.field,n=e.value,i=e.ignoreCase,o=e.operator;return{value:JSON.stringify(t.toUTC(n)).replace(/"/g,""),field:r,ignoreCase:i,operator:o}},t.toLower=function(e){var r=e.field,n=e.value,i=e.ignoreCase,o=e.operator;return{field:(u=["tolower(",")"],u.raw=["tolower(",")"],t.wrapIf(function(){return i})(u,r)),value:n,ignoreCase:i,operator:o};var u},t.normalizeField=function(e){var t=e.field,r=e.value,n=e.ignoreCase,i=e.operator;return{value:r,field:t.replace(/\./g,"/"),ignoreCase:n,operator:i}},t.isStringValue=function(e){return n.isString(e.value)},t.isDateValue=function(e){return n.isDate(e.value)},t.serializeFilters=function(e,r){return function(n){var i=t.wrapIf(function(){return n.filters.length>1});return o=["(",")"],o.raw=["(",")"],i(o,n.filters.map(e).join(r(n)));var o}}},function(e,t,r){"use strict";var n=r(1),i=r(2),o=r(8),u=r(5),s=r(6),a=function(e){return function(t){return e+"="+t}},c=function(){return""},f=function(e){return i.isPresent(e)&&i.isArray(e)&&e.length>0},l=function(e){return function(t){return i.isPresent(e(t))}},g=function(e){return function(t){return f(e(t))}},p=function(e,t){return u.either(e,t,c)},d=function(e){var t=e.skip,r=e.take;return Math.floor((t||0)/r)+1},v=function(e,t){return function(r){return e(r).map(t).join("~")}},m=function(e){return function(t){return t.slice(0,t.indexOf(e))}},h=function(e){return u.compose.apply(void 0,e.map(function(e){var t=e[0],r=e[1];return function(e){return e.replace(new RegExp(t,"g"),r)}}))},y=h([['"',""],[":","-"]]),x=m("."),D=function(e){var t=e.field,r=e.dir,n=void 0===r?"asc":r;return t+"-"+n},S=function(e){var t=e.field,r=e.aggregate;return t+"-"+r},q=o.getter("take"),C=o.getter("aggregates"),F=o.getter("skip"),O=o.getter("group"),_=o.getter("sort",!0),b=v(_,D),N=v(O,D),k=v(C,S),w=function(e){return"datetime'"+e+"'"},E=u.compose(w,x,y,JSON.stringify,s.toUTC),T=function(e){var t=e.field,r=e.value,n=e.ignoreCase,i=e.operator;return{value:E(r),field:t,ignoreCase:n,operator:i}},B=function(e){return Object.assign({},e,{sort:(_(e)||[]).filter(function(e){var t=e.dir;return i.isNotNullOrEmptyString(t)})})},z=u.compose(a("page"),d),j=u.compose(a("pageSize"),q),P=u.compose(a("group"),N),I=u.compose(a("sort"),b),A=u.compose(a("aggregate"),k),$=p(l(F),z),R=p(l(q),j),L=p(g(O),P),G=p(l(C),A),V=u.compose(p(g(_),I),B),M=function(e){var t=e.field;return i.isNotNullOrEmptyString(t)},U=function(e){var t=e.field,r=e.operator,n=e.value;return t+"~"+r+"~"+n},K=u.either(s.isDateValue,u.compose(U,T),U),Y=p(M,u.either(s.isStringValue,u.compose(U,s.quote),K)),H=function(e){var t=e.logic;return"~"+t+"~"},J=s.serializeFilters(function(e){return u.either(n.isCompositeFilterDescriptor,J,Y)(e)},H),Q=function(e){var t=e.filter;if(t&&t.filters){var r=J(t);if(r.length)return"filter="+r}return""},W=function(e){return function(t){return{aggregates:G(e),filter:Q(e),group:L(e),skip:$(e),sort:V(e),take:R(e)}[t]}};t.toDataSourceRequestString=function(e){return Object.keys(e).map(W(e)).filter(i.isNotNullOrEmptyString).join("&")}},function(e,t,r){"use strict";var n=r(2),i=["",""],o=function(e,t){return[e[0]+t[0],e[1]+t[1]]},u=function(e){return!n.isNullOrEmptyString(e)},s=function(e,t,r){var n="(",i=e.indexOf("[");return i===-1?e="."+e:i>0&&(n+="(",e="."+e.substring(0,i)+" || {})"+e.substring(i)),e+=t<r-1?" || {})":")",[n,e]},a=function(e,t){return e.filter(u).reduce(function(e,t,r,n){return o(e,s(t,r,n.length))},i).join(t)},c={};t.expr=function(e,t,r){return void 0===e&&(e=""),void 0===t&&(t=!1),void 0===r&&(r="d"),e&&"["!==e.charAt(0)&&(e="."+e),t?(e=e.replace(/"([^.]*)\.([^"]*)"/g,'"$1_$DOT$_$2"'),e=e.replace(/'([^.]*)\.([^']*)'/g,"'$1_$DOT$_$2'"),e=a(e.split("."),r),e=e.replace(/_\$DOT\$_/g,".")):e=r+e,e},t.getter=function(e,r){var n=e+r;return c[n]=c[n]||new Function("d","return "+t.expr(e,r))}},function(e,t,r){"use strict";var n=r(2),i=r(5),o=function(e,t,r){return t[e]=r,t},u=function(e){return function(t){return Object.keys(t).reduce(e.bind(null,t),{})}},s=u(function(e,t,r){return o(r.toLowerCase(),t,e[r])}),a=u(function(e,t,r){return o(r,t,s(e[r]))}),c=function(e,t){return n.isPresent(e)?e:t},f=function(e){return{aggregates:e.Aggregates||e.aggregates,field:e.Member||e.member||e.field,hasSubgroups:e.HasSubgroups||e.hasSubgroups||!1,items:e.Items||e.items,value:c(e.Key,c(e.key,e.value))}},l=i.compose(function(e){var t=e.field,r=e.hasSubgroups,n=e.value,i=e.aggregates,o=e.items;return{aggregates:a(i),field:t,items:r?o.map(l):o,value:n}},f);t.translateDataSourceResultGroups=function(e){return e.map(l)},t.translateAggregateResults=function(e){return(e||[]).reduce(function(e,t){return o(t.Member,e,o(t.AggregateMethodName.toLowerCase(),e[t.Member]||{},t.Value))},{})}},function(e,t,r){"use strict";var n=r(2),i=r(11),o=r(12),u=r(16),s=r(15),a=r(13),c=r(8),f=r(5);t.orderBy=function(e,t){if(t.some(function(e){return n.isPresent(e.dir)})){e=e.slice(0);var r=i.composeSortDescriptors(t);e.sort(r)}return e};var l=function(e,t){return e===t},g=function(e){if(n.isString(e)){var t=c.getter(e);e=function(e,r){return t(e)===t(r)}}return e},p=function(e,t){return e.filter(function(e,r,n){return n.findIndex(t.bind(null,e))===r})};t.distinct=function(e,t){return void 0===t&&(t=l),p(e,g(t))},t.count=function(e,t){for(var r=0,n=0,i=e.length;n<i;n++)t(e[n])&&r++;return r},t.limit=function(e,t){return t?e.filter(t):e},t.process=function(e,r){var i=r.skip,c=r.take,l=r.filter,g=r.sort,p=r.group,d=o.normalizeGroups(p||[]).concat(g||[]);d.length&&(e=t.orderBy(e,d));var v=n.isPresent(l)&&a.filter.length,m=n.isPresent(p)&&p.length;if(!v&&!m)return{data:c?e.slice(i,i+c):e,total:e.length};var h,y,x=[];if(v?(y=s.compileFilter(u.normalizeFilters(l)),h=t.count(e,y),x.push(a.filter(y))):h=e.length,n.isPresent(i)&&n.isPresent(c)&&(x.push(a.skip(i)),x.push(a.take(c))),x.length){var D=f.compose.apply(void 0,x),S=m?o.groupBy(e,p,D,t.limit(e,y)):a.exec(D(a.concat),[],e);return{data:S,total:h}}return{data:m?o.groupBy(e,p):e,total:h}}},function(e,t,r){"use strict";var n=r(2),i=r(8),o=function(e,t){return n.isBlank(e)?e===t?0:-1:n.isBlank(t)?1:e.localeCompare?e.localeCompare(t):e>t?1:e<t?-1:0},u=function(e,t){return o(t,e)},s=function(e){var t=i.getter(e.field);return function(r,n){return("asc"===e.dir?o:u)(t(r),t(n))}},a=function(e,t){return 0};t.composeSortDescriptors=function(e){return e.filter(function(e){return n.isPresent(e.dir)}).map(function(e){return s(e)}).reduce(function(e,t){return function(r,n){return e(r,n)||t(r,n)}},a)}},function(e,t,r){"use strict";var n=r(13),i=r(2),o=r(14),u=r(15);t.normalizeGroups=function(e){return e=i.isArray(e)?e:[e],e.map(function(e){return Object.assign({dir:"asc"},e)})};var s=n.map(function(e){return e});t.groupBy=function(e,r,a,c){if(void 0===r&&(r=[]),void 0===a&&(a=s),void 0===c&&(c=e),r=t.normalizeGroups(r),!r.length)return e;var f=r[0],l={},g=n.exec(a(n.groupCombinator(f.field)),l,e),p=[];return Object.keys(g).forEach(function(e){Object.keys(g[e]).forEach(function(n){var a=g[e][n],l={},d=c;i.isPresent(f.aggregates)&&(d=u.filterBy(c,{field:f.field,ignoreCase:!1,operator:"eq",value:a.value}),l=o.aggregateBy(d,f.aggregates)),p[a.__position]={aggregates:l,field:e,items:r.length>1?t.groupBy(a.items,r.slice(1),s,d):a.items,value:a.value}})}),p}},function(e,t,r){"use strict";var n=r(2),i=r(8),o=function(e){return e=n.isPresent(e)&&e.getTime?e.getTime():e,e+""};t.groupCombinator=function(e){var t=i.getter(e,!0),r=0;return function(n,i){n[e]=n[e]||{};var u=t(i),s=o(u),a=n[e][s]||{__position:r++,aggregates:{},items:[],value:u};return a.items.push(i),n[e][s]=a,n}},t.expandAggregates=function(e){return void 0===e&&(e={}),Object.keys(e).forEach(function(t){var r=e[t];Object.keys(r).forEach(function(e){r[e]=r[e].result()})}),e};var u=function(e){return{average:function(){var e=0,t=0;return{calc:function(r){n.isNumeric(r)?(e+=r,t++):e=r},result:function(){return n.isNumeric(e)?e/t:e}}},count:function(){var e=0;return{calc:function(){return e++},result:function(){return e}}},max:function(){var e=Number.NEGATIVE_INFINITY;return{calc:function(t){e=n.isNumeric(e)||n.isDate(e)?e:t,e<t&&(n.isNumeric(t)||n.isDate(t))&&(e=t)},result:function(){return e}}},min:function(){var e=Number.POSITIVE_INFINITY;return{calc:function(t){e=n.isNumeric(e)||n.isDate(e)?e:t,e>t&&(n.isNumeric(t)||n.isDate(t))&&(e=t)},result:function(){return e}}},sum:function(){var e=0;return{calc:function(t){return e+=t},result:function(){return e}}}}[e]()};t.aggregatesCombinator=function(e){var t=e.map(function(e){var t=i.getter(e.field,!0),r=(e.aggregate||"").toLowerCase(),n=i.getter(r,!0);return function(i,o){var s=t(i)||{},a=n(s)||u(r);return a.calc(t(o)),s[e.aggregate]=a,i[e.field]=s,i}});return function(e,r){return t.reduce(function(e,t){return t(e,r)},e)}},t.concat=function(e,t){return e.push(t),e},t.map=function(e){return function(t){return function(r,n,i){return t(r,e(n,i))}}},t.filter=function(e){return function(t){return function(r,n){return e(n)?t(r,n):r}}},t.isTransformerResult=function(e){return n.isPresent(e.__value)};var s=function(e){return t.isTransformerResult(e)?e:{__value:e,reduced:!0}};t.take=function(e){return function(t){return function(r,n){return e-- >0?t(r,n):s(r)}}},t.takeWhile=function(e){return function(t){return function(r,n){return e(n)?t(r,n):s(r)}}},t.skip=function(e){return function(t){return function(r,n){return e--<=0?t(r,n):r}}},t.exec=function(e,r,n){for(var i=r,o=0,u=n.length;o<u;o++)if(i=e(i,n[o],o),t.isTransformerResult(i)){i=i.__value;break}return i}},function(e,t,r){"use strict";var n=r(13),i=n.map(function(e){return e});t.aggregateBy=function(e,t,r){void 0===t&&(t=[]),void 0===r&&(r=i);var o={};if(!t.length)return o;var u=n.exec(r(n.aggregatesCombinator(t)),o,e);return n.expandAggregates(u)}},function(e,t,r){"use strict";var n=r(8),i=r(2),o=r(1),u=r(16),s={and:" && ",or:" || "},a=function(e,t){if(i.isFunction(e)){var r="__f["+t.length+"](d)";return[r,t.concat([e])]}return[n.expr(e),t]},c=function(e,t,r){if(i.isFunction(e.operator)){var n="__o["+t.length+"]("+r+", "+u.operators.quote(e.value)+")";return[n,t.concat([e.operator])]}var o=!i.isPresent(e.ignoreCase)||e.ignoreCase;return[u.operators[e.operator||"eq"](r,e.value,o),t]},f=function(e,t,r,n){var i=a(e.field,n),o=i[0],u=i[1],s=c(e,r,o),f=s[0],l=s[1];return{expression:t.concat([f]),fields:u,operators:l}},l=function(){return{compositeFilterExpression:function(e,t,r,n){var i=l.filterExpr(e),o=i.expression.replace(/__o\[(\d+)\]/g,function(e,t){return"__o["+(r.length+ +t)+"]"}).replace(/__f\[(\d+)\]/g,function(e,t){return"__f["+(n.length+ +t)+"]"});return{expression:t.concat([o]),fields:n.concat(i.fields),operators:r.concat(i.operators)}},createExpression:function(e,t){return o.isCompositeFilterDescriptor(t)?l.compositeFilterExpression(t,e.expression,e.operators,e.fields):f(t,e.expression,e.operators,e.fields)},filterExpr:function(e){for(var t=e.filters,r={expression:[],fields:[],operators:[]},n=0,i=t.length;n<i;n++)r=l.createExpression(r,t[n]);return{expression:"("+r.expression.join(s[e.logic])+")",fields:r.fields,operators:r.operators}}}}();t.filterExpr=l.filterExpr,t.compileFilter=function(e){if(!e||0===e.filters.length)return function(){return!0};var r=t.filterExpr(e),n=new Function("d, __f, __o","return "+r.expression),i=r.fields.length||r.operators.length;return i?function(e){return n(e,r.fields,r.operators)}:n},t.filterBy=function(e,r){return!i.isPresent(r)||o.isCompositeFilterDescriptor(r)&&0===r.filters.length?e:e.filter(t.compileFilter(u.normalizeFilters(r)))}},function(e,t,r){"use strict";var n=r(2),i=r(1),o=/^\/Date\((.*?)\)\/$/,u=/(\r+|\n+)/g,s=/(?=['\\])/g,a=function(e){return{"!=":"neq","<":"lt","<=":"lte","==":"eq",">":"gt",">=":"gte",equal:"eq",equals:"eq",equalto:"eq",ge:"gte",greater:"gt",greaterthan:"gt",greaterthanequal:"gte",isempty:"isempty",isequalto:"eq",isgreaterthan:"gt",isgreaterthanorequalto:"gte",islessthan:"lt",islessthanorequalto:"lte",isnotempty:"isnotempty",isnotequalto:"neq",isnull:"isnull",le:"lte",less:"lt",lessthan:"lt",lessthanequal:"lte",ne:"neq",notequal:"neq",notequals:"neq",notequalto:"neq",notsubstringof:"doesnotcontain"}[e.toLowerCase()]||e},c=function(e){var t=e.filters||[];t.forEach(function(e){!i.isCompositeFilterDescriptor(e)&&n.isString(e.operator)&&(e.operator=a(e.operator)),i.isCompositeFilterDescriptor(e)&&c(e)})},f=function(e){return i.isCompositeFilterDescriptor(e)?e:{filters:n.isArray(e)?e:[e],logic:"and"}};t.normalizeFilters=function(e){return n.isPresent(e)&&(e=f(e),c(e)),e},t.operators=function(){var e=function(e){return e.replace(s,"\\").replace(u,"")},t=function(t,r,i,u){if(null!=i){if(n.isString(i)){i=e(i);var s=o.exec(i);s?i=new Date(+s[1]):u?(i="'"+i.toLowerCase()+"'",r="(("+r+" || '')+'').toLowerCase()"):i="'"+i+"'"}i.getTime&&(r="("+r+" && "+r+".getTime?"+r+".getTime():"+r+")",i=i.getTime())}return r+" "+t+" "+i},r=function(t,r,n,i){return i&&(r="("+r+" || '').toLowerCase()",n&&(n=n.toLowerCase())),n&&(n=e(n)),t(r,n)};return{contains:function(e,t,n){return r(function(e,t){return e+".indexOf('"+t+"') >= 0"},e,t,n)},doesnotcontain:function(e,t,n){return r(function(e,t){return e+".indexOf('"+t+"') == -1"},e,t,n)},doesnotendwith:function(e,t,n){return r(function(e,t){return e+".indexOf('"+t+"', "+e+".length - "+(t||"").length+") < 0"},e,t,n)},doesnotstartwith:function(e,t,n){return r(function(e,t){return e+".lastIndexOf('"+t+"', 0) == -1"},e,t,n)},endswith:function(e,t,n){return r(function(e,t){return e+".indexOf('"+t+"', "+e+".length - "+(t||"").length+") >= 0"},e,t,n)},eq:function(e,r,n){return t("==",e,r,n)},gt:function(e,r,n){return t(">",e,r,n)},gte:function(e,r,n){return t(">=",e,r,n)},isempty:function(e){return e+" === ''"},isnotempty:function(e){return e+" !== ''"},isnotnull:function(e){return"("+e+" !== null && "+e+" !== undefined)"},isnull:function(e){return"("+e+" === null || "+e+" === undefined)"},lt:function(e,r,n){return t("<",e,r,n)},lte:function(e,r,n){return t("<=",e,r,n)},neq:function(e,r,n){return t("!=",e,r,n)},quote:function(t){return t&&t.getTime?"new Date("+t.getTime()+")":n.isString(t)?"'"+e(t)+"'":""+t},startswith:function(e,t,n){return r(function(e,t){return e+".lastIndexOf('"+t+"', 0) == 0"},e,t,n)}}}()}])});